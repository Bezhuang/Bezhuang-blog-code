<!DOCTYPE html>
<html lang="zh-CN,en,default">
  <head hexo-theme='https://github.com/volantis-x/hexo-theme-volantis/tree/4.3.0'>
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
    
  
  <!-- 渲染优化 -->
  <meta http-equiv='x-dns-prefetch-control' content='on' />
  <link rel='dns-prefetch' href='https://cdn.jsdelivr.net'>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <link rel="preload" href="/css/first.css" as="style">
  

  <!-- 页面元数据 -->
  
  <title>Python for everybody - Bezhuang&#39;s Blog</title>
  
    <meta name="keywords" content="Python,SQL">
  

  
    <meta name="description" content="
The Python for Everybody Specialization provided by UNIVERSITY OF MICHIGAN introduces fundamental programming concepts including data structures, networked ...">
  

  <!-- feed -->
  
    <link rel="alternate" href="/atom.xml" title="Bezhuang's Blog" type="application/atom+xml">
  

  <!-- import meta -->
  

  <!-- link -->
  

  <!-- import link -->
  

  
    
<link rel="stylesheet" href="/css/first.css">

  

  
  <link rel="stylesheet" href="/css/style.css" media="print" onload="this.media='all';this.onload=null">
  <noscript><link rel="stylesheet" href="/css/style.css"></noscript>
  

  <script id="loadcss"></script>

  

<script>if (/*@cc_on!@*/false || (!!window.MSInputMethodContext && !!document.documentMode)) window.location.href="https://support.dmeng.net/upgrade-your-browser.html?referrer="+encodeURIComponent(window.location.href); </script>


</head>

  <body>
    <script src="https://cdn.jsdelivr.net/gh/zyoushuo/Blog/hexo/js/clicksocialist.js"></script>
    

<header id="l_header" class="l_header always shadow floatable blur show"  >
  <div class='container'>
  <div id='wrapper'>
    <div class='nav-sub'>
      <p class="title"></p>
      <ul class='switcher nav-list-h m-phone' id="pjax-header-nav-list">
        <li><a id="s-comment" class="fas fa-comments fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
          <li><a id="s-toc" class="s-toc fas fa-list fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href='/'>
          
          
          
            Bezhuang's Blog
          
        </a>
      

			<div class='menu navigation'>
				<ul class='nav-list-h m-pc'>
          
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>首页
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于我
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" 
                  
                  
                  >
                  <i class='fas fa-ellipsis-v fa-fw'></i>更多
                </a>
                
                  <ul class="list-v">
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/friends/
                  
                  
                  
                    id="friends"
                  >
                  <i class='fas fa-link fa-fw'></i>友情链接
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box header toggle-mode-btn">
                  <i class='fas fa-moon fa-fw'></i>暗黑模式
                </a>
              <li>
            
          
                    
                  </ul>
                
              </li>
            
          
          
				</ul>
			</div>

      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fas fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="Search..." />
        </form>
      </div>

			<ul class='switcher nav-list-h m-phone'>
				
					<li><a class="s-search fas fa-search fa-fw" target="_self" href='javascript:void(0)'></a></li>
				
				<li>
          <a class="s-menu fas fa-bars fa-fw" target="_self" href='javascript:void(0)'></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/
                  
                  
                  
                    id="home"
                  >
                  <i class='fas fa-rss fa-fw'></i>首页
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  <i class='fas fa-folder-open fa-fw'></i>分类
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  <i class='fas fa-tags fa-fw'></i>标签
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  <i class='fas fa-archive fa-fw'></i>归档
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/about/
                  
                  
                  
                    id="about"
                  >
                  <i class='fas fa-info-circle fa-fw'></i>关于我
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" 
                  
                  
                  >
                  <i class='fas fa-ellipsis-v fa-fw'></i>更多
                </a>
                
                  <ul class="list-v">
                    
                      
            
              <li>
                <a class="menuitem flat-box faa-parent animated-hover" href=/friends/
                  
                  
                  
                    id="friends"
                  >
                  <i class='fas fa-link fa-fw'></i>友情链接
                </a>
                
              </li>
            
          
                    
                      
            
              <li>
                <a class="menuitem flat-box header toggle-mode-btn">
                  <i class='fas fa-moon fa-fw'></i>暗黑模式
                </a>
              <li>
            
          
                    
                  </ul>
                
              </li>
            
          
            
          </ul>
        </li>
			</ul>
		</div>
	</div>
  </div>
</header>

    <div id="l_body">
      <div id="l_cover">
  
    
        <div id="full" class='cover-wrapper post search' style="display: none;">
          
            <div class='cover-bg' style='background-image:url(https://cdn.jsdelivr.net/gh/Bezhuang/Imgbed/blogimg/%E5%A3%81%E7%BA%B82.jpg)'></div>
          
          <div class='cover-body'>
  <div class='top'>
    
    
      <p class="title">庄之皓 · Bezhuang</p>
    
    
      <p class="subtitle">欢迎访问我的博客！Welcome to my blog!</p>
    
  </div>
  <div class='bottom'>
    
      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <input type="text" class="input u-search-input" placeholder="search here..." />
          <i class="icon fas fa-search fa-fw"></i>
        </form>
      </div>
    
    <div class='menu navigation'>
      <div class='list-h'>
        
          
            <a href="/photos"
              
              
              id="photos">
              <p>相册</p>
            </a>
          
            <a href="/projects"
              
              
              id="projects">
              <p>开源库</p>
            </a>
          
            <a href="/todo"
              
              
              id="todo">
              <p>计划表</p>
            </a>
          
            <a href="/guestbook"
              
              
              id="guestbook">
              <p>留言板</p>
            </a>
          
        
      </div>
    </div>
  </div>
</div>

          <div id="scroll-down" style="display: none;"><i class="fa fa-chevron-down scroll-down-effects"></i></div>
        </div>
    
  
  </div>

      <div id="safearea">
        <div class="body-wrapper" id="pjax-container">
          

<div class='l_main'>
  <article class="article post white-box reveal md shadow article-type-post" id="post" itemscope itemprop="blogPost">
  


  
  <div class="article-meta" id="top">
    
    
    
      <h1 class="title">
        Python for everybody
      </h1>
      <div class='new-meta-box'>
        
          
            
  <div class='new-meta-item category'>
    <a class='notlink'>
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <a class="category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">计算机基础</a>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2020年5月14日</p>
  </a>
</div>

          
        
          
            
  <div class="new-meta-item wordcount">
    <a class='notlink'>
      <i class="fas fa-keyboard fa-fw" aria-hidden="true"></i>
      <p>字数：5.5k字</p>
    </a>
  </div>
  <div class="new-meta-item readtime">
    <a class='notlink'>
      <i class="fas fa-hourglass-half fa-fw" aria-hidden="true"></i>
      <p>时长：34分钟</p>
    </a>
  </div>


          
        
      </div>
    
  </div>


  
  
  <blockquote>
<p>The Python for Everybody Specialization provided by UNIVERSITY OF MICHIGAN introduces fundamental programming concepts including data structures, networked application program interfaces, and databases, using the Python programming language. Python for Everybody is a completely open-source course, you can find all the notes and textbooks on its official <a target="_blank" rel="noopener" href="https://www.py4e.com/">website</a>, so this note will only contain my solution to all post-lesson exercises in this course.</p>
</blockquote>
<a id="more"></a>



	<div class="row">
    <embed src="/pdf/Coursera-py4e.pdf" width="100%" height="550" type="application/pdf">
	</div>




<h3 id="Chapter-1"><a href="#Chapter-1" class="headerlink" title="Chapter 1"></a>Chapter 1</h3><h4 id="Question-1"><a href="#Question-1" class="headerlink" title="Question 1"></a>Question 1</h4><p>Write a program that uses a <strong>print</strong> statement to say ‘hello world’ as shown in ‘Desired Output’.<br><strong>Desired Output</strong></p>
<pre><code>hello world</code></pre>
<p><strong>Solution</strong></p>
<pre><code class="python">print(&quot;hello world&quot;)</code></pre>
<h3 id="Chapter-2"><a href="#Chapter-2" class="headerlink" title="Chapter 2"></a>Chapter 2</h3><h4 id="Question-1-1"><a href="#Question-1-1" class="headerlink" title="Question 1"></a>Question 1</h4><p>Write a program to prompt the user for hours and rate per hour using input to compute gross pay. Use 35 hours and a rate of 2.75 per hour to test the program (the pay should be 96.25). You should use <strong>input</strong> to read a string and <strong>float()</strong> to convert the string to a number. Do not worry about error checking or bad user data.<br><strong>Desired Output</strong></p>
<pre><code>Pay: 96.25</code></pre>
<p><strong>Solution</strong></p>
<pre><code>hrs = input(&quot;Enter Hours: &quot;)
rat = input(&quot;Enter Rates: &quot;)
pay = float(hrs) * float(rat)
print(&quot;Pay: &quot; + str(pay))</code></pre>
<h3 id="Chapter-3"><a href="#Chapter-3" class="headerlink" title="Chapter 3"></a>Chapter 3</h3><h4 id="Question-1-2"><a href="#Question-1-2" class="headerlink" title="Question 1"></a>Question 1</h4><p>Write a program to prompt the user for hours and rate per hour using input to compute gross pay. Pay the hourly rate for the hours up to 40 and 1.5 times the hourly rate for all hours worked above 40 hours. Use 45 hours and a rate of 10.50 per hour to test the program (the pay should be 498.75). You should use <strong>input</strong> to read a string and <strong>float()</strong> to convert the string to a number. Do not worry about error checking the user input - assume the user types numbers properly.<br><strong>Desired Output</strong></p>
<pre><code>498.75</code></pre>
<p><strong>Solution</strong></p>
<pre><code>hrs = input(&quot;Enter Hours:&quot;)
h = float(hrs)
rat = input(&quot;Enter Rates:&quot;)
r = float(rat)
if h &lt;=40:
    pay = h * r
else:
    pay = 40 * r + (h - 40) * r * 1.5
print(str(pay))</code></pre>
<h4 id="Question-2"><a href="#Question-2" class="headerlink" title="Question 2"></a>Question 2</h4><p>Write a program to prompt for a score between 0.0 and 1.0. If the score is out of range, print an error. If the score is between 0.0 and 1.0, print a grade using the following table:<br>Score Grade<br>&gt;= 0.9 A<br>&gt;= 0.8 B<br>&gt;= 0.7 C<br>&gt;= 0.6 D<br>&lt; 0.6 F<br>If the user enters a value out of range, print a suitable error message and exit. For the test, enter a score of 0.85.<br><strong>Desired Output</strong></p>
<pre><code>B</code></pre>
<p><strong>Solution</strong></p>
<pre><code>score = input(&quot;Enter Score: &quot;)
sco = float(score)
if 0.0 &lt;= sco &lt;= 1.0:
    if sco &gt;= 0.9:
        grade = &quot;A&quot;
    elif sco &gt;= 0.8:
        grade = &quot;B&quot;
    elif sco &gt;= 0.7:
        grade = &quot;C&quot;
    elif sco &gt;= 0.6:
        grade = &quot;D&quot;
    else:
        grade = &quot;F&quot;
    print(grade)
else:
    print(&quot;error&quot;)</code></pre>
<h3 id="Chapter-4"><a href="#Chapter-4" class="headerlink" title="Chapter 4"></a>Chapter 4</h3><h4 id="Question-1-3"><a href="#Question-1-3" class="headerlink" title="Question 1"></a>Question 1</h4><p>Write a program to prompt the user for hours and rate per hour using input to compute gross pay. Pay should be the normal rate for hours up to 40 and time-and-a-half for the hourly rate for all hours worked above 40 hours. Put the logic to do the computation of pay in a function called <strong>computepay()</strong> and use the function to do the computation. The function should return a value. Use 45 hours and a rate of 10.50 per hour to test the program (the pay should be 498.75). You should use <strong>input</strong> to read a string and <strong>float()</strong> to convert the string to a number. Do not worry about error checking the user input unless you want to - you can assume the user types numbers properly. Do not name your variable sum or use the sum() function.<br><strong>Desired Output</strong></p>
<pre><code>Pay 498.75</code></pre>
<p><strong>Solution</strong></p>
<pre><code>def computepay(h,r):
    if h &lt;= 40:
        p = h * r
    else:
        p = 40 * r + (h - 40) * 1.5 * r
    return p
hrs = input(&quot;Enter Hours:&quot;)
ho = float(hrs)
rat = input(&quot;Enter Rates:&quot;)
ro = float(rat)
p = computepay(ho,ro)
print(&quot;Pay&quot;,p)</code></pre>
<h3 id="Chapter-5"><a href="#Chapter-5" class="headerlink" title="Chapter 5"></a>Chapter 5</h3><h4 id="Question-1-4"><a href="#Question-1-4" class="headerlink" title="Question 1"></a>Question 1</h4><p>Write a program that repeatedly prompts a user for integer numbers until the user enters ‘done’. Once ‘done’ is entered, print out the largest and smallest of the numbers. If the user enters anything other than a valid number catch it with a try/except and put out an appropriate message and ignore the number. Enter 7, 2, bob, 10, and 4 and match the output below.<br><strong>Desired Output</strong></p>
<pre><code>Invalid input
Maximum is 10
Minimum is 2</code></pre>
<p><strong>Solution</strong></p>
<pre><code>largest = None
smallest = None
shuzi = []
while True:
    num = input(&quot;Enter a number: &quot;)
    if num == &quot;done&quot; : break
    else:
        try:
            numm = int(num)
            shuzi.append(numm)
        except:
            print(&quot;Invalid input&quot;)
            continue
largest = max(shuzi)
smallest = min(shuzi)
print(&quot;Maximum is&quot;, largest)
print(&quot;Minimum is&quot;, smallest)</code></pre>
<h3 id="Chapter-6"><a href="#Chapter-6" class="headerlink" title="Chapter 6"></a>Chapter 6</h3><h4 id="Question-1-5"><a href="#Question-1-5" class="headerlink" title="Question 1"></a>Question 1</h4><p>Write code using find() and string slicing (see section 6.10) to extract the number at the end of the line below. Convert the extracted value to a floating point number and print it out.<br><strong>Desired Output</strong></p>
<pre><code>0.8475</code></pre>
<p><strong>Solution</strong></p>
<pre><code>text = &quot;X-DSPAM-Confidence:    0.8475&quot;;
shuziqian = text.find(&#39;:&#39;)
number = float(text[shuziqian+1:])
print(number)</code></pre>
<h3 id="Chapter-7"><a href="#Chapter-7" class="headerlink" title="Chapter 7"></a>Chapter 7</h3><h4 id="Question-1-6"><a href="#Question-1-6" class="headerlink" title="Question 1"></a>Question 1</h4><p>Write a program that prompts for a file name, then opens that file and reads through the file, looking for lines of the form:</p>
<pre><code>X-DSPAM-Confidence:    0.8475</code></pre>
<p>Count these lines and extract the floating point values from each of the lines and compute the average of those values and produce an output as shown below. Do not use the sum() function or a variable named sum in your solution.<br>You can download the sample data at <a target="_blank" rel="noopener" href="https://www.py4e.com/code3/mbox-short.txt">http://www.py4e.com/code3/mbox-short.txt</a> when you are testing below enter <strong>mbox-short.txt</strong> as the file name.<br><strong>Desired Output</strong></p>
<pre><code>Average spam confidence: 0.750718518519</code></pre>
<p><strong>Solution</strong></p>
<pre><code># Use the file name mbox-short.txt as the file name
fname = input(&quot;Enter file name: &quot;)
fh = open(fname)
value = 0
count = 0
for line in fh:
    if not line.startswith(&quot;X-DSPAM-Confidence:&quot;) :
        continue
    shuziqian = line.find(&#39;:&#39;)+1
    value = float(line[shuziqian:]) + value
    count = count + 1
print(&quot;Average spam confidence:&quot;,value / count)</code></pre>
<h3 id="Chapter-8"><a href="#Chapter-8" class="headerlink" title="Chapter 8"></a>Chapter 8</h3><h4 id="Question-1-7"><a href="#Question-1-7" class="headerlink" title="Question 1"></a>Question 1</h4><p>Open the file <strong>romeo.txt</strong> and read it line by line. For each line, split the line into a list of words using the <strong>split()</strong> method. The program should build a list of words. For each word on each line check to see if the word is already in the list and if not append it to the list. When the program completes, sort and print the resulting words in alphabetical order.<br>You can download the sample data at <a target="_blank" rel="noopener" href="https://www.py4e.com/code3/romeo.txt">http://www.py4e.com/code3/romeo.txt</a><br><strong>Desired Output</strong></p>
<pre><code>[&#39;Arise&#39;, &#39;But&#39;, &#39;It&#39;, &#39;Juliet&#39;, &#39;Who&#39;, &#39;already&#39;, &#39;and&#39;, &#39;breaks&#39;, &#39;east&#39;, &#39;envious&#39;, &#39;fair&#39;, &#39;grief&#39;, &#39;is&#39;, &#39;kill&#39;, &#39;light&#39;, &#39;moon&#39;, &#39;pale&#39;, &#39;sick&#39;, &#39;soft&#39;, &#39;sun&#39;, &#39;the&#39;, &#39;through&#39;, &#39;what&#39;, &#39;window&#39;, &#39;with&#39;, &#39;yonder&#39;]</code></pre>
<p><strong>Solution</strong></p>
<pre><code>fname = input(&quot;Enter file name: &quot;)
fh = open(fname)
lst = list()
for line in fh:
    line = line.strip()
    words = line.split()
    for word in words:
        if word not in lst:
            lst.append(word)
print(sorted(lst))</code></pre>
<h4 id="Question-2-1"><a href="#Question-2-1" class="headerlink" title="Question 2"></a>Question 2</h4><p>Open the file <strong>mbox-short.txt</strong> and read it line by line. When you find a line that starts with ‘From ‘ like the following line:</p>
<pre><code>From stephen.marquard@uct.ac.za Sat Jan  5 09:14:16 2008</code></pre>
<p>You will parse the From line using split() and print out the second word in the line (i.e. the entire address of the person who sent the message). Then print out a count at the end.<br><strong>Hint:</strong> make sure not to include the lines that start with ‘From:’.<br>You can download the sample data at <a target="_blank" rel="noopener" href="https://www.py4e.com/code3/mbox-short.txt">http://www.py4e.com/code3/mbox-short.txt</a><br><strong>Desired Output</strong></p>
<pre><code>stephen.marquard@uct.ac.za
louis@media.berkeley.edu
zqian@umich.edu
rjlowe@iupui.edu
zqian@umich.edu
rjlowe@iupui.edu
cwen@iupui.edu
cwen@iupui.edu
gsilver@umich.edu
gsilver@umich.edu
zqian@umich.edu
gsilver@umich.edu
wagnermr@iupui.edu
zqian@umich.edu
antranig@caret.cam.ac.uk
gopal.ramasammycook@gmail.com
david.horwitz@uct.ac.za
david.horwitz@uct.ac.za
david.horwitz@uct.ac.za
david.horwitz@uct.ac.za
stephen.marquard@uct.ac.za
louis@media.berkeley.edu
louis@media.berkeley.edu
ray@media.berkeley.edu
cwen@iupui.edu
cwen@iupui.edu
cwen@iupui.edu
There were 27 lines in the file with From as the first word</code></pre>
<p><strong>Solution</strong></p>
<pre><code>fname = input(&quot;Enter file name: &quot;)
if len(fname) &lt; 1 : fname = &quot;mbox-short.txt&quot;
fh = open(fname)
count = 0
for line in fh:
    line = line.strip()
    if not line.startswith(&quot;From &quot;):
        continue
    words = line.split()
    print(words[1])
    count = count + 1
print(&quot;There were&quot;, count, &quot;lines in the file with From as the first word&quot;)</code></pre>
<h3 id="Chapter-9"><a href="#Chapter-9" class="headerlink" title="Chapter 9"></a>Chapter 9</h3><h4 id="Question-1-8"><a href="#Question-1-8" class="headerlink" title="Question 1"></a>Question 1</h4><p>Write a program to read through the <strong>mbox-short.txt</strong> and figure out who has sent the greatest number of mail messages. The program looks for ‘From ‘ lines and takes the second word of those lines as the person who sent the mail. The program creates a Python dictionary that maps the sender’s mail address to a count of the number of times they appear in the file. After the dictionary is produced, the program reads through the dictionary using a maximum loop to find the most prolific committer.<br><strong>Desired Output</strong></p>
<pre><code>cwen@iupui.edu 5</code></pre>
<p><strong>Solution</strong></p>
<pre><code>fname = input(&quot;Enter file name: &quot;)
if len(fname) &lt; 1 : fname = &quot;mbox-short.txt&quot;

fh = open(fname)
count_dict = dict()

for line in fh:
    line = line.strip()
    if not line.startswith(&#39;From &#39;):
        continue
    words = line.split()
    count_dict[words[1]] = 1 + count_dict.get(words[1],0)
sort_list = sorted([(v,k) for k,v in count_dict.items()],reverse=True)
print(sort_list[0][1],sort_list[0][0])</code></pre>
<h3 id="Chapter-10"><a href="#Chapter-10" class="headerlink" title="Chapter 10"></a>Chapter 10</h3><h4 id="Question-1-9"><a href="#Question-1-9" class="headerlink" title="Question 1"></a>Question 1</h4><p>Write a program to read through the <strong>mbox-short.txt</strong> and figure out the distribution by hour of the day for each of the messages. You can pull the hour out from the ‘From ‘ line by finding the time and then splitting the string a second time using a colon.</p>
<pre><code>From stephen.marquard@uct.ac.za Sat Jan  5 09:14:16 2008</code></pre>
<p>Once you have accumulated the counts for each hour, print out the counts, sorted by hour as shown below.<br><strong>Desired Output</strong></p>
<pre><code>04 3
06 1
07 1
09 2
10 3
11 6
14 1
15 2
16 4
17 2
18 1
19 1</code></pre>
<p><strong>Solution</strong></p>
<pre><code>fname = input(&quot;Enter file name: &quot;)
if len(fname) &lt; 1 : fname = &quot;mbox-short.txt&quot;
fh = open(fname)
count_dict = dict()
for line in fh:
    line = line.strip()
    if not line.startswith(&#39;From &#39;):
        continue
    words = line.split()
    times = words[5].split(&#39;:&#39;)
    hours = times[0]
    count_dict[hours] = 1 + count_dict.get(hours,0)
count_list = sorted([(k,v) for k,v in count_dict.items()])
for k,v in count_list:
    print(k,v)</code></pre>
<h3 id="Chapter-11"><a href="#Chapter-11" class="headerlink" title="Chapter 11"></a>Chapter 11</h3><h4 id="Question-1-10"><a href="#Question-1-10" class="headerlink" title="Question 1"></a>Question 1</h4><p><strong>Handling The Data</strong><br>The basic outline of this problem is to read the file, look for integers using the <strong>re.findall()</strong>, looking for a regular expression of <strong>‘[0-9]+’</strong> and then converting the extracted strings to integers and summing up the integers.<br><strong>Solution</strong></p>
<pre><code>import re
file = open(&#39;C:/Users/dell/Desktop/regex_sum_501451.txt&#39;, &#39;r&#39;)
file_data = file.read()
numbers_str = re.findall(&#39;[0-9]+&#39;, file_data)
total = 0
for number_str in numbers_str:
    total = total + int(number_str)
print(total)</code></pre>
<h3 id="Chapter-12"><a href="#Chapter-12" class="headerlink" title="Chapter 12"></a>Chapter 12</h3><h4 id="Question-1-11"><a href="#Question-1-11" class="headerlink" title="Question 1"></a>Question 1</h4><p><strong>Exploring the HyperText Transport Protocol</strong><br>You are to retrieve the following document using the HTTP protocol in a way that you can examine the HTTP Response headers.</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://data.pr4e.org/intro-short.txt">http://data.pr4e.org/intro-short.txt</a><br>There are three ways that you might retrieve this web page and look at the response headers:</li>
<li><strong>Preferred:</strong> Modify the <a target="_blank" rel="noopener" href="https://www.py4e.com/code3/socket1.py">socket1.py</a> program to retrieve the above URL and print out the headers and data. Make sure to <strong>change</strong> the code to retrieve the above URL - the values are different for each URL.</li>
<li>Open the URL in a web browser with a developer console or FireBug and manually examine the headers that are returned.</li>
<li>Use the <strong>telnet</strong> program as shown in lecture to retrieve the headers and content.<br><strong>Desired Output</strong></li>
</ul>
<pre><code>HTTP/1.1 200 OK
Date: Sun, 01 Oct 2017 05:25:59 GMT
Server: Apache/2.4.7 (Ubuntu)
Last-Modified: Sat, 13 May 2017 11:22:22 GMT
ETag: “1d3-54f6609240717”
Accept-Ranges: bytes
Content-Length: 467
Cache-Control: max-age=0, no-cache, no-store, must-revalidate
Pragma: no-cache
Expires: Wed, 11 Jan 1984 05:00:00 GMT
Connection: close
Content-Type: text/plain</code></pre>
<p><strong>Solution</strong></p>
<pre><code>import socket

mysock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
mysock.connect((&#39;data.pr4e.org&#39;, 80))
cmd = &#39;GET http://data.pr4e.org/intro-short.txt HTTP/1.0\r\n\r\n&#39;.encode()
mysock.send(cmd)
while True:
    data = mysock.recv(512)
    if (len(data) &lt; 1):
        break
    print(data.decode())
mysock.close()</code></pre>
<h4 id="Question-2-2"><a href="#Question-2-2" class="headerlink" title="Question 2"></a>Question 2</h4><p><strong>Scraping Numbers from HTML using BeautifulSoup</strong> In this assignment you will write a Python program similar to <a target="_blank" rel="noopener" href="https://www.py4e.com/code3/urllink2.py">http://www.py4e.com/code3/urllink2.py</a>. The program will use <strong>urllib</strong> to read the HTML from the data files below, and parse the data, extracting numbers and compute the sum of the numbers in the file.<br>We provide two files for this assignment. One is a sample file where we give you the sum for your testing and the other is the actual data you need to process for the assignment.</p>
<ul>
<li>Sample data: <a target="_blank" rel="noopener" href="http://py4e-data.dr-chuck.net/comments_42.html">http://py4e-data.dr-chuck.net/comments_42.html</a> (Sum=2553)</li>
<li>Actual data: <a target="_blank" rel="noopener" href="http://py4e-data.dr-chuck.net/comments_501453.html">http://py4e-data.dr-chuck.net/comments_501453.html</a> (Sum ends with 35)<br>You do not need to save these files to your folder since your program will read the data directly from the URL. <strong>Note:</strong> Each student will have a distinct data url for the assignment - so only use your own data url for analysis.<br><strong>Solution</strong></li>
</ul>
<pre><code>from urllib.request import urlopen
from bs4 import BeautifulSoup
import ssl
# Ignore SSL certificate errors
ctx = ssl.create_default_context()
ctx.check_hostname = False
ctx.verify_mode = ssl.CERT_NONE
url = input(&#39;Enter - &#39;)
html = urlopen(url, context=ctx).read()
# html.parser is the HTML parser included in the standard Python 3 library.
# information on other HTML parsers is here:
# http://www.crummy.com/software/BeautifulSoup/bs4/doc/#installing-a-parser
soup = BeautifulSoup(html, &quot;html.parser&quot;)
# Retrieve all of the anchor tags
tags = soup(&#39;span&#39;)
total = 0
for tag in tags:
    # Look at the parts of a tag
    total = total + int(tag.contents[0])
print(total)</code></pre>
<h4 id="Question-3"><a href="#Question-3" class="headerlink" title="Question 3"></a>Question 3</h4><p><strong>Following Links in Python</strong><br>In this assignment you will write a Python program that expands on <a target="_blank" rel="noopener" href="https://www.py4e.com/code3/urllinks.py">http://www.py4e.com/code3/urllinks.py</a>. The program will use <strong>urllib</strong> to read the HTML from the data files below, extract the href= vaues from the anchor tags, scan for a tag that is in a particular position relative to the first name in the list, follow that link and repeat the process a number of times and report the last name you find.<br>We provide two files for this assignment. One is a sample file where we give you the name for your testing and the other is the actual data you need to process for the assignment</p>
<ul>
<li>Sample problem: Start at <a target="_blank" rel="noopener" href="http://py4e-data.dr-chuck.net/known_by_Fikret.html">http://py4e-data.dr-chuck.net/known_by_Fikret.html</a><br>Find the link at position <strong>3</strong> (the first name is 1). Follow that link. Repeat this process <strong>4</strong> times. The answer is the last name that you retrieve.<br>Sequence of names: Fikret Montgomery Mhairade Butchi Anayah<br>Last name in sequence: Anayah</li>
<li>Actual problem: Start at: <a target="_blank" rel="noopener" href="http://py4e-data.dr-chuck.net/known_by_Malaeka.html">http://py4e-data.dr-chuck.net/known_by_Malaeka.html</a><br>Find the link at position <strong>18</strong> (the first name is 1). Follow that link. Repeat this process <strong>7</strong> times. The answer is the last name that you retrieve.<br>Hint: The first character of the name of the last page that you will load is: K<br><strong>Solution</strong></li>
</ul>
<pre><code>  import urllib.request
import urllib.parse
import urllib.error
from bs4 import BeautifulSoup
import ssl
def findUrl(url, position):
    html = urllib.request.urlopen(url, context=ctx).read()
    soup = BeautifulSoup(html, &#39;html.parser&#39;)
    # Retrieve all of the anchor tags
    tags = soup(&#39;a&#39;)
    return tags[position].get(&#39;href&#39;, None)
# Ignore SSL certificate errors
ctx = ssl.create_default_context()
ctx.check_hostname = False
ctx.verify_mode = ssl.CERT_NONE
count_str = input(&#39;Enter count - &#39;)
count = int(count_str)
position_str = input(&#39;Enter position - &#39;)
position = int(position_str)-1
for i in range(count):
    if i == 0:
        url_now = input(&#39;Enter - &#39;)
        print(url_now)
        url_now = findUrl(url_now, position)
        print(url_now)
    else:
        url_now = findUrl(url_now, position)
        print(url_now)</code></pre>
<h3 id="Chapter-13"><a href="#Chapter-13" class="headerlink" title="Chapter 13"></a>Chapter 13</h3><h4 id="Question-1-12"><a href="#Question-1-12" class="headerlink" title="Question 1"></a>Question 1</h4><p><strong>Extracting Data from XML</strong><br>In this assignment you will write a Python program somewhat similar to <a target="_blank" rel="noopener" href="https://www.py4e.com/code3/geoxml.py">http://www.py4e.com/code3/geoxml.py</a>. The program will prompt for a URL, read the XML data from that URL using <strong>urllib</strong> and then parse and extract the comment counts from the XML data, compute the sum of the numbers in the file.<br>We provide two files for this assignment. One is a sample file where we give you the sum for your testing and the other is the actual data you need to process for the assignment.</p>
<ul>
<li>Sample data: <a target="_blank" rel="noopener" href="http://py4e-data.dr-chuck.net/comments_42.xml">http://py4e-data.dr-chuck.net/comments_42.xml</a> (Sum=2553)</li>
<li>Actual data: <a target="_blank" rel="noopener" href="http://py4e-data.dr-chuck.net/comments_501455.xml">http://py4e-data.dr-chuck.net/comments_501455.xml</a> (Sum ends with 78)<br>You do not need to save these files to your folder since your program will read the data directly from the URL. <strong>Note:</strong> Each student will have a distinct data url for the assignment - so only use your own data url for analysis.<br><strong>Solution</strong></li>
</ul>
<pre><code>import urllib.request
import urllib.parse
import urllib.error
import xml.etree.ElementTree as ET
url = &#39;http://py4e-data.dr-chuck.net/comments_501455.xml&#39;
print(&#39;Retrieving&#39;, url)
uh = urllib.request.urlopen(url)
data = uh.read()
print(&#39;Retrieved&#39;, len(data), &#39;characters&#39;)
tree = ET.fromstring(data)
comments_node = tree.findall(&#39;comments&#39;)
comment_node = comments_node[0].findall(&#39;comment&#39;)
total = 0
for node in comment_node:
    total = total + int(node.find(&#39;count&#39;).text)
print(total)</code></pre>
<h4 id="Question-2-3"><a href="#Question-2-3" class="headerlink" title="Question 2"></a>Question 2</h4><p><strong>Extracting Data from JSON</strong><br>In this assignment you will write a Python program somewhat similar to <a target="_blank" rel="noopener" href="https://www.py4e.com/code3/json2.py">http://www.py4e.com/code3/json2.py</a>. The program will prompt for a URL, read the JSON data from that URL using <strong>urllib</strong> and then parse and extract the comment counts from the JSON data, compute the sum of the numbers in the file and enter the sum below:<br>We provide two files for this assignment. One is a sample file where we give you the sum for your testing and the other is the actual data you need to process for the assignment.</p>
<ul>
<li>Sample data: <a target="_blank" rel="noopener" href="http://py4e-data.dr-chuck.net/comments_42.json">http://py4e-data.dr-chuck.net/comments_42.json</a> (Sum=2553)</li>
<li>Actual data: <a target="_blank" rel="noopener" href="http://py4e-data.dr-chuck.net/comments_501456.json">http://py4e-data.dr-chuck.net/comments_501456.json</a> (Sum ends with 42)<br>You do not need to save these files to your folder since your program will read the data directly from the URL. <strong>Note:</strong> Each student will have a distinct data url for the assignment - so only use your own data url for analysis.<br><strong>Solution</strong></li>
</ul>
<pre><code>import urllib.request
import urllib.parse
import urllib.error
import json
url = &#39;http://py4e-data.dr-chuck.net/comments_501456.json&#39;
print(&#39;Retrieving&#39;, url)
uh = urllib.request.urlopen(url)
data = uh.read()
info = json.loads(data.decode())
print(&#39;User count:&#39;, len(info))
comments_dic = info[&#39;comments&#39;]
total = 0
for item in comments_dic:
    total = total + int(item[&#39;count&#39;])
print(total)</code></pre>
<h4 id="Question-3-1"><a href="#Question-3-1" class="headerlink" title="Question 3"></a>Question 3</h4><p><strong>Calling a JSON API</strong><br>In this assignment you will write a Python program somewhat similar to <a target="_blank" rel="noopener" href="https://www.py4e.com/code3/geojson.py">http://www.py4e.com/code3/geojson.py</a>. The program will prompt for a location, contact a web service and retrieve JSON for the web service and parse that data, and retrieve the first <strong>place_id</strong> from the JSON. A place ID is a textual identifier that uniquely identifies a place as within Google Maps.<br><strong>API End Points</strong><br>To complete this assignment, you should use this API endpoint that has a static subset of the Google Data:</p>
<pre><code>http://py4e-data.dr-chuck.net/json?</code></pre>
<p>This API uses the same parameter (address) as the Google API. This API also has no rate limit so you can test as often as you like. If you visit the URL with no parameters, you get “No address…” response.<br>To call the API, you need to include a <strong>key=</strong> parameter and provide the address that you are requesting as the <strong>address=</strong> parameter that is properly URL encoded using the <strong>urllib.parse.urlencode()</strong> function as shown in <a target="_blank" rel="noopener" href="https://www.py4e.com/code3/geojson.py">http://www.py4e.com/code3/geojson.py</a><br>Make sure to check that your code is using the API endpoint is as shown above. You will get <em>different</em> results from the <strong>geojson</strong> and <strong>json</strong> endpoints so make sure you are using the same end point as this autograder is using.<br><strong>Solution</strong></p>
<pre><code>import urllib.request
import urllib.parse
import urllib.error
import json
import ssl
api_key = False
# If you have a Google Places API key, enter it here
# api_key = &#39;AIzaSy___IDByT70&#39;
# https://developers.google.com/maps/documentation/geocoding/intro
if api_key is False:
    api_key = 42
    serviceurl = &#39;http://py4e-data.dr-chuck.net/json?&#39;
else:
    serviceurl = &#39;https://maps.googleapis.com/maps/api/geocode/json?&#39;
# Ignore SSL certificate errors
ctx = ssl.create_default_context()
ctx.check_hostname = False
ctx.verify_mode = ssl.CERT_NONE
while True:
    address = input(&#39;Enter location: &#39;)
    if len(address) &lt; 1:
        break
    parms = dict()
    parms[&#39;address&#39;] = address
    if api_key is not False:
        parms[&#39;key&#39;] = api_key
    url = serviceurl + urllib.parse.urlencode(parms)
    print(&#39;Retrieving&#39;, url)
    uh = urllib.request.urlopen(url, context=ctx)
    data = uh.read().decode()
    print(&#39;Retrieved&#39;, len(data), &#39;characters&#39;)
    try:
        js = json.loads(data)
    except:
        js = None
    if not js or &#39;status&#39; not in js or js[&#39;status&#39;] != &#39;OK&#39;:
        print(&#39;==== Failure To Retrieve ====&#39;)
        print(data)
        continue
    print(json.dumps(js, indent=4))
    lat = js[&#39;results&#39;][0][&#39;geometry&#39;][&#39;location&#39;][&#39;lat&#39;]
    lng = js[&#39;results&#39;][0][&#39;geometry&#39;][&#39;location&#39;][&#39;lng&#39;]
    print(&#39;lat&#39;, lat, &#39;lng&#39;, lng)
    location = js[&#39;results&#39;][0][&#39;formatted_address&#39;]
    print(location)</code></pre>
<h3 id="Chapter-15"><a href="#Chapter-15" class="headerlink" title="Chapter 15"></a>Chapter 15</h3><h4 id="Question-1-13"><a href="#Question-1-13" class="headerlink" title="Question 1"></a>Question 1</h4><p>create a SQLITE database or use an existing database and create a table in the database called “Ages”:</p>
<pre><code>CREATE TABLE Ages (
  name VARCHAR(128),
  age INTEGER
)</code></pre>
<p>Then make sure the table is empty by deleting any rows that you previously inserted, and insert these rows and only these rows with the following commands:</p>
<pre><code>DELETE FROM Ages;
INSERT INTO Ages (name, age) VALUES (&#39;Muqadaas&#39;, 29);
INSERT INTO Ages (name, age) VALUES (&#39;Sabine&#39;, 13);
INSERT INTO Ages (name, age) VALUES (&#39;Brydon&#39;, 35);
INSERT INTO Ages (name, age) VALUES (&#39;Jayla&#39;, 39);</code></pre>
<p>Once the inserts are done, run the following SQL command:</p>
<pre><code>SELECT hex(name || age) AS X FROM Ages ORDER BY X</code></pre>
<h4 id="Question-2-4"><a href="#Question-2-4" class="headerlink" title="Question 2"></a>Question 2</h4><p><strong>Counting Organizations</strong><br>This application will read the mailbox data (mbox.txt) and count the number of email messages per organization (i.e. domain name of the email address) using a database with the following schema to maintain the counts.</p>
<pre><code>CREATE TABLE Counts (org TEXT, count INTEGER)</code></pre>
<p>When you have run the program on <strong>mbox.txt</strong> upload the resulting database file above for grading.<br>If you run the program multiple times in testing or with dfferent files, make sure to empty out the data before each run.<br>You can use this code as a starting point for your application: <a target="_blank" rel="noopener" href="https://www.py4e.com/code3/emaildb.py">http://www.py4e.com/code3/emaildb.py</a>.<br>The data file for this application is the same as in previous assignments: <a target="_blank" rel="noopener" href="https://www.py4e.com/code3/mbox.txt">http://www.py4e.com/code3/mbox.txt</a>.<br><strong>Solution</strong></p>
<pre><code>import sqlite3
conn = sqlite3.connect(&#39;emaildb2.sqlite&#39;)
cur = conn.cursor()
cur.execute(&#39;&#39;&#39;
DROP TABLE IF EXISTS Counts&#39;&#39;&#39;)
cur.execute(&#39;&#39;&#39;
CREATE TABLE Counts (org TEXT, count INTEGER)&#39;&#39;&#39;)
fh = open(&#39;C:/Users/dell/Desktop/mbox.txt&#39;, &#39;r&#39;)
list_1 = []
for line in fh:
    if not line.startswith(&#39;From: &#39;):
        continue
    pieces = line.split()
    email = pieces[1]
    dom = email.find(&#39;@&#39;)
    org = email[dom+1:len(email)]
    cur.execute(&#39;SELECT count FROM Counts WHERE org = ? &#39;, (org,))
    row = cur.fetchone()
    if row is None:
        cur.execute(&#39;&#39;&#39;INSERT INTO Counts (org, count)
                VALUES (?, 1)&#39;&#39;&#39;, (org,))
    else:
        cur.execute(&#39;UPDATE Counts SET count = count + 1 WHERE org = ?&#39;,
                    (org,))
conn.commit()
# https://www.sqlite.org/lang_select.html
sqlstr = &#39;SELECT org, count FROM Counts ORDER BY count DESC LIMIT 10&#39;
for row in cur.execute(sqlstr):
    print(str(row[0]), row[1])
cur.close()</code></pre>
<h4 id="Question-3-2"><a href="#Question-3-2" class="headerlink" title="Question 3"></a>Question 3</h4><p><strong>Musical Track Database</strong><br>This application will read an iTunes export file in XML and produce a properly normalized database with this structure:</p>
<pre><code>CREATE TABLE Artist (
    id  INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT UNIQUE,
    name    TEXT UNIQUE
);
CREATE TABLE Genre (
    id  INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT UNIQUE,
    name    TEXT UNIQUE
);
CREATE TABLE Album (
    id  INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT UNIQUE,
    artist_id  INTEGER,
    title   TEXT UNIQUE
);
CREATE TABLE Track (
    id  INTEGER NOT NULL PRIMARY KEY
        AUTOINCREMENT UNIQUE,
    title TEXT  UNIQUE,
    album_id  INTEGER,
    genre_id  INTEGER,
    len INTEGER, rating INTEGER, count INTEGER
);</code></pre>
<p>If you run the program multiple times in testing or with different files, make sure to empty out the data before each run.<br>You can use this code as a starting point for your application: <a target="_blank" rel="noopener" href="https://www.py4e.com/code3/tracks.zip">http://www.py4e.com/code3/tracks.zip</a>. The ZIP file contains the <strong>Library.xml</strong> file to be used for this assignment. You can export your own tracks from iTunes and create a database, but for the database that you turn in for this assignment, only use the <strong>Library.xml</strong> data that is provided.<br>To grade this assignment, the program will run a query like this on your uploaded database and look for the data it expects to see:</p>
<pre><code>SELECT Track.title, Artist.name, Album.title, Genre.name
    FROM Track JOIN Genre JOIN Album JOIN Artist
    ON Track.genre_id = Genre.ID and Track.album_id = Album.id
        AND Album.artist_id = Artist.id
    ORDER BY Artist.name LIMIT 3</code></pre>
<p>The expected result of the modified query on your database is: (shown here as a simple HTML table with titles)<br><strong>Solution</strong></p>
<pre><code>import xml.etree.ElementTree as ET
import sqlite3
conn = sqlite3.connect(&#39;trackdb.sqlite&#39;)
cur = conn.cursor()
# Make some fresh tables using executescript()
cur.executescript(&#39;&#39;&#39;
DROP TABLE IF EXISTS Artist;
DROP TABLE IF EXISTS Album;
DROP TABLE IF EXISTS Genre;
DROP TABLE IF EXISTS Track;
CREATE TABLE Artist (
    id  INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT UNIQUE,
    name    TEXT UNIQUE
);
CREATE TABLE Album (
    id  INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT UNIQUE,
    artist_id  INTEGER,
    title   TEXT UNIQUE
);
CREATE TABLE Genre (
    id  INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT UNIQUE,
    name   TEXT UNIQUE
);
CREATE TABLE Track (
    id  INTEGER NOT NULL PRIMARY KEY
        AUTOINCREMENT UNIQUE,
    title TEXT  UNIQUE,
    album_id  INTEGER,
    genre_id  INTEGER,
    len INTEGER, rating INTEGER, count INTEGER
);
&#39;&#39;&#39;)
fname = input(&#39;Enter file name: &#39;)
if (len(fname) &lt; 1):
    fname = &#39;Library.xml&#39;
# &lt;key&gt;Track ID&lt;/key&gt;&lt;integer&gt;369&lt;/integer&gt;
# &lt;key&gt;Name&lt;/key&gt;&lt;string&gt;Another One Bites The Dust&lt;/string&gt;
# &lt;key&gt;Artist&lt;/key&gt;&lt;string&gt;Queen&lt;/string&gt;
def lookup(d, key):
    found = False
    for child in d:
        if found:
            return child.text
        if child.tag == &#39;key&#39; and child.text == key:
            found = True
    return None
stuff = ET.parse(fname)
all = stuff.findall(&#39;dict/dict/dict&#39;)
print(&#39;Dict count:&#39;, len(all))
for entry in all:
    if (lookup(entry, &#39;Track ID&#39;) is None):
        continue
    name = lookup(entry, &#39;Name&#39;)
    artist = lookup(entry, &#39;Artist&#39;)
    album = lookup(entry, &#39;Album&#39;)
    genre = lookup(entry, &#39;Genre&#39;)
    count = lookup(entry, &#39;Play Count&#39;)
    rating = lookup(entry, &#39;Rating&#39;)
    length = lookup(entry, &#39;Total Time&#39;)
    if name is None or artist is None or album is None:
        continue
    print(name, artist, album, genre, count, rating, length)
    cur.execute(&#39;&#39;&#39;INSERT OR IGNORE INTO Artist (name)
        VALUES ( ? )&#39;&#39;&#39;, (artist, ))
    cur.execute(&#39;SELECT id FROM Artist WHERE name = ? &#39;, (artist, ))
    artist_id = cur.fetchone()[0]
    cur.execute(&#39;&#39;&#39;INSERT OR IGNORE INTO Album (title, artist_id)
        VALUES ( ?, ? )&#39;&#39;&#39;, (album, artist_id))
    cur.execute(&#39;SELECT id FROM Album WHERE title = ? &#39;, (album, ))
    album_id = cur.fetchone()[0]
    cur.execute(&#39;&#39;&#39;INSERT OR IGNORE INTO Genre (name)
    VALUES ( ? )&#39;&#39;&#39;, (genre, ))
    cur.execute(&#39;SELECT id FROM Genre WHERE name = ? &#39;, (genre, ))
    genre_id = cur.fetchone()[0]
    cur.execute(&#39;&#39;&#39;INSERT OR REPLACE INTO Track
        (title, album_id, genre_id, len, rating, count)
        VALUES ( ?, ?, ?, ?, ?, ?)&#39;&#39;&#39;,
                (name, album_id, genre_id, length, rating, count))
    conn.commit()</code></pre>
<h4 id="Question-4"><a href="#Question-4" class="headerlink" title="Question 4"></a>Question 4</h4><p>This application will read roster data in JSON format, parse the file, and then produce an SQLite database that contains a User, Course, and Member table and populate the tables from the data file.<br>You can base your solution on this code: <a target="_blank" rel="noopener" href="https://www.py4e.com/code3/roster/roster.py">http://www.py4e.com/code3/roster/roster.py</a> - this code is incomplete as you need to modify the program to store the <strong>role</strong> column in the <strong>Member</strong> table to complete the assignment.<br>Each student gets their own file for the assignment. Download <a target="_blank" rel="noopener" href="https://www.py4e.com/tools/sql-intro/roster_data.php?PHPSESSID=4e9bbaef3d818a7530c32084639a353c">this file</a> and save it as <code>roster_data.json</code>. Move the downloaded file into the same folder as your <code>roster.py</code> program.<br>Once you have made the necessary changes to the program and it has been run successfully reading the above JSON data, run the following SQL command:</p>
<pre><code>SELECT hex(User.name || Course.title || Member.role ) AS X FROM
    User JOIN Member JOIN Course
    ON User.id = Member.user_id AND Member.course_id = Course.id
    ORDER BY X</code></pre>
<p>Find the <strong>first</strong> row in the resulting record set and enter the long string that looks like <strong>53656C696E613333</strong>.<br><strong>Solution</strong></p>
<pre><code>import json
import sqlite3
# PART 1: Creating the database
dbname = &quot;roster.sqlite&quot;
conn = sqlite3.connect(dbname)
cur = conn.cursor()
cur.executescript(&#39;&#39;&#39;
    DROP TABLE IF EXISTS User;
    DROP TABLE IF EXISTS Course;
    DROP TABLE IF EXISTS Member;
    CREATE TABLE User (
        id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT UNIQUE,
        name TEXT UNIQUE
    );
    CREATE TABLE Course (
        id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT UNIQUE,
        title TEXT UNIQUE
    );
    CREATE TABLE Member (
        user_id INTEGER,
        course_id INTEGER,
        role INTEGER,
        PRIMARY KEY(user_id, course_id)
    )
&#39;&#39;&#39;)
# Note: if we don&#39;t add UNIQUE after &quot;User.name&quot; and &quot;Course.title&quot;,
# the IGNORE statement won&#39;t work and therefore we&#39;ll have duplicates
# PART 2: DESERIALIZING THE data
# The JSON data we&#39;re going to process is stored in an array form, with each
# item being also an array of three elements: one corresponding to the username
# one corresponding to the course name, and one indicating if the user is instructor
# None of them has any field title.
filename = &quot;roster_data.json&quot;
jsondata = open(&#39;C:/Users/dell/Desktop/roster_data.json&#39;)
data = json.load(jsondata)
# PART 3: INSERTING DATA
for entry in data:
    user = entry[0]
    course = entry[1]
    instructor = entry[2]
    # Inserting user
    user_statement = &quot;&quot;&quot;INSERT OR IGNORE INTO User(name) VALUES( ? )&quot;&quot;&quot;
    SQLparams = (user, )
    cur.execute(user_statement, SQLparams)
    # Inserting course
    course_statement = &quot;&quot;&quot;INSERT OR IGNORE INTO Course(title) VALUES( ? )&quot;&quot;&quot;
    SQLparams = (course, )
    cur.execute(course_statement, SQLparams)
    # Getting user and course id
    courseID_statement = &quot;&quot;&quot;SELECT id FROM Course WHERE title = ?&quot;&quot;&quot;
    SQLparams = (course, )
    cur.execute(courseID_statement, SQLparams)
    courseID = cur.fetchone()[0]
    userID_statement = &quot;&quot;&quot;SELECT id FROM User WHERE name = ?&quot;&quot;&quot;
    SQLparams = (user, )
    cur.execute(userID_statement, SQLparams)
    userID = cur.fetchone()[0]
    # Inserting the entry
    member_statement = &quot;&quot;&quot;INSERT INTO Member(user_id, course_id, role)
        VALUES(?, ?, ?)&quot;&quot;&quot;
    SQLparams = (userID, courseID, instructor)
    cur.execute(member_statement, SQLparams)
# Saving the changes
conn.commit()
# PART 4: Testing and obtaining the results
test_statement = &quot;&quot;&quot;
SELECT hex(User.name || Course.title || Member.role ) AS X FROM
    User JOIN Member JOIN Course
    ON User.id = Member.user_id AND Member.course_id = Course.id
    ORDER BY X
&quot;&quot;&quot;
cur.execute(test_statement)
result = cur.fetchone()
print(&quot;RESULT: &quot; + str(result))
# Closing the connection
cur.close()
conn.close()</code></pre>

  
  
    
    <div class='footer'>
      
        <div class='references'>
          <section class='header'>
            
              <i class="fas fa-quote-left fa-fw" aria-hidden="true"></i>
            
            <span>References</span>
          </section>
          <section class='body'>
            <ul>
              
                <li>
                  <a href="https://blog.csdn.net/u012348774/article/details/78106407" rel="external nofollow noopener noreferrer" target="_blank">
                  Python学习-PY4E作业
                  </a>
                </li>
              
            </ul>
          </section>
        </div>
      
      
      
        <div class='copyright'>
          <blockquote>
            
              
                <p>This work is licensed under a <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.</p>

              
            
          </blockquote>
        </div>
      
      
    </div>
  
  
    


  <div class='article-meta' id="bottom">
    <div class='new-meta-box'>
      
        
          
<div class='new-meta-item author'>
  <a class='author' href="/about" rel="nofollow">
    <img no-lazy src="https://cn.bing.com/th?id=AMMS_fc8f99fd41ebd737a71c4e13806db9a0&w=110&h=110&c=7&rs=1&qlt=80&pcl=f9f9f9&cdv=1&dpr=2&pid=16.1">
    <p>Bezhuang</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/Python/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>Python</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/SQL/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>SQL</p></a></div>


        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.zhuangzhihao.top/Python-for-Everybody/&title=Python for everybody - Bezhuang's Blog&summary=
The Python for Everybody Specialization provided by UNIVERSITY OF MICHIGAN introduces fundamental programming concepts including data structures, networked application program interfaces, and databases, using the Python programming language. Python for Everybody is a completely open-source course, you can find all the notes and textbooks on its official website, so this note will only contain my solution to all post-lesson exercises in this course.
"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://blog.zhuangzhihao.top/Python-for-Everybody/&title=Python for everybody - Bezhuang's Blog&summary=
The Python for Everybody Specialization provided by UNIVERSITY OF MICHIGAN introduces fundamental programming concepts including data structures, networked application program interfaces, and databases, using the Python programming language. Python for Everybody is a completely open-source course, you can find all the notes and textbooks on its official website, so this note will only contain my solution to all post-lesson exercises in this course.
"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="" rel="external nofollow noopener noreferrer noopener"
          
          target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.zhuangzhihao.top/Python-for-Everybody/&title=Python for everybody - Bezhuang's Blog&summary=
The Python for Everybody Specialization provided by UNIVERSITY OF MICHIGAN introduces fundamental programming concepts including data structures, networked application program interfaces, and databases, using the Python programming language. Python for Everybody is a completely open-source course, you can find all the notes and textbooks on its official website, so this note will only contain my solution to all post-lesson exercises in this course.
"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/weibo.png">
          
        </a>
      
    
      
        
        <div class='hoverbox'>
          <a class='share'><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/wechat.png"></a>
          <div class='target'>
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAEYCAAAAACi5bZQAAAC+ElEQVR42u3aQZIiMQwEQP7/6dkH7BB2SWJBS/o2wHTbqUuF5MeP9et6IAADBgwYMGDWwDyK668HNj8/Pf/0vKnzgAEDBgwYMGD2wVwHoCcHSjeWHrS6n/g8YMCAAQMGDJi1MOlBTgEuDYbp86qFAgMGDBgwYMCAqQa02/ekwRAMGDBgwIABA6bbWKoGu+kBHxgwYMCAAQPme2DSAdWrB2DdAeDbJpFgwIABAwYMmH8Gk67bjb3r7/J5wIABAwYMGDBrYLprqrFVbXSlge54HjBgwIABAwbMGpipxlB6EajacKpCXYODAQMGDBgwYNbBVC/cpBd+0vd2B3/xvsCAAQMGDBgwa2C6QFNBsdsoqwZSMGDAgAEDBsxemHRA1n7xi0HawRMMGDBgwIABsxYmbSx1g2K3IZXu7wgLBgwYMGDAgFkDMxWwqheIuheB0sIcfwcGDBgwYMCAWQOTXuCpXmBO4VLIauA8Jl8wYMCAAQMGzMfDVDdSheoO1qYGgceABwYMGDBgwID5eJjqqm5oOkim7wUDBgwYMGDA/L8wU42oE0S1EFXQdsADAwYMGDBgwHwMTLXhc9tIqga1tFBTgzcwYMCAAQMGzD6YuKFzGby635cPGEKDAQMGDBgwYPbBTAWl6u+mGmbVAoABAwYMGDBg9sNUG0PdwVp3YJe+91ggMGDAgAEDBsw6mKkDdRtf0xBxQcGAAQMGDBgwa2GmN9QNjulArhpIwYABAwYMGDB7YVKAtDE0FQynCwMGDBgwYMCA2QvTXWmAmz5QtSH2tDBgwIABAwYMmDUwr9poNfBNXUBKgyUYMGDAgAEDZi9MGuiqv09h08bZeMADAwYMGDBgwKyBSQNUNdiVB2LNxtfxeWDAgAEDBgyYr4XpBrUUNC3Y8XMwYMCAAQMGzNfCpMHqFrob/D6+UQUGDBgwYMCAefvALQWtgnQL9vS5YMCAAQMGDJh1MNXB1S1E9/+7g73bAoABAwYMGDBg9sBYYMCAAQMGDJhl6w/x0aJ7KpOomAAAAABJRU5ErkJggg==">
          </div>
        </div>
      
    
      
        <a class="-mob-share-telegram" title="" rel="external nofollow noopener noreferrer noopener"
          
            target="_blank" href="https://t.me/share/url?url=http://blog.zhuangzhihao.top/Python-for-Everybody/&text=Python for everybody - Bezhuang's Blog"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-org/logo/128/telegram.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </div>


  
  

  
    <div class="prev-next">
      
        <a class='prev' href='/Data-Science-Math-Skills/'>
          <p class='title'><i class="fas fa-chevron-left" aria-hidden="true"></i>Data Science Math Skills</p>
          <p class='content'>
Data Science Math Skills course provided by DUKE UNIVERSITY is designed to teach the vocabulary,...</p>
        </a>
      
      
        <a class='next' href='/Sport-Related-Concussion-Training/'>
          <p class='title'>Sport-Related Concussion Training<i class="fas fa-chevron-right" aria-hidden="true"></i></p>
          <p class='content'>
Some common sports injuries can occur when engaging in confrontational sports like basketball, t...</p>
        </a>
      
    </div>
  
</article>


  

  <article class="post white-box reveal shadow" id="comments">
    <p ct><i class='fas fa-comments'></i> 评论</p>
    
    <div id="valine_container" class="valine_thread">
  <i class="fas fa-cog fa-spin fa-fw fa-2x"></i>
</div>

  </article>






</div>
<aside class='l_side'>
  
  
    
    



  <section class="widget toc-wrapper shadow desktop mobile" id="toc-div" >
    
  <header>
    
      <i class="fas fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


    <div class='content'>
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Chapter-1"><span class="toc-text">Chapter 1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-1"><span class="toc-text">Question 1</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Chapter-2"><span class="toc-text">Chapter 2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-1-1"><span class="toc-text">Question 1</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Chapter-3"><span class="toc-text">Chapter 3</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-1-2"><span class="toc-text">Question 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-2"><span class="toc-text">Question 2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Chapter-4"><span class="toc-text">Chapter 4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-1-3"><span class="toc-text">Question 1</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Chapter-5"><span class="toc-text">Chapter 5</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-1-4"><span class="toc-text">Question 1</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Chapter-6"><span class="toc-text">Chapter 6</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-1-5"><span class="toc-text">Question 1</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Chapter-7"><span class="toc-text">Chapter 7</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-1-6"><span class="toc-text">Question 1</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Chapter-8"><span class="toc-text">Chapter 8</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-1-7"><span class="toc-text">Question 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-2-1"><span class="toc-text">Question 2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Chapter-9"><span class="toc-text">Chapter 9</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-1-8"><span class="toc-text">Question 1</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Chapter-10"><span class="toc-text">Chapter 10</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-1-9"><span class="toc-text">Question 1</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Chapter-11"><span class="toc-text">Chapter 11</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-1-10"><span class="toc-text">Question 1</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Chapter-12"><span class="toc-text">Chapter 12</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-1-11"><span class="toc-text">Question 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-2-2"><span class="toc-text">Question 2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-3"><span class="toc-text">Question 3</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Chapter-13"><span class="toc-text">Chapter 13</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-1-12"><span class="toc-text">Question 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-2-3"><span class="toc-text">Question 2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-3-1"><span class="toc-text">Question 3</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Chapter-15"><span class="toc-text">Chapter 15</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-1-13"><span class="toc-text">Question 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-2-4"><span class="toc-text">Question 2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-3-2"><span class="toc-text">Question 3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Question-4"><span class="toc-text">Question 4</span></a></li></ol></li></ol>
    </div>
  </section>


  


</aside>



		  
		  <!--此文件用来存放一些不方便取值的变量-->
<!--思路大概是将值藏到重加载的区域内-->

<script>
  window.pdata={}
  pdata.ispage=true;
  pdata.postTitle="Python for everybody";
  pdata.commentPath="";
  pdata.commentPlaceholder="";

  var l_header=document.getElementById("l_header");
  
  l_header.classList.add("show");
  
</script>

        </div>
        
  
  <footer class="footer clearfix">
    <br><br>
    
      
        
          <div><p>Copyright © 2021 Zhihao Zhuang. All rights reserved</p>
</div>
        
      
    
      
        
          <div><p><span id="lc-uv">本站访客数<span id='number'><i class="fas fa-circle-notch fa-spin fa-fw" aria-hidden="true"></i></span>人 | </span> <span id="lc-sv">总访问量<span id='number'><i class="fas fa-circle-notch fa-spin fa-fw" aria-hidden="true"></i></span>次</span></p>
</div>
        
      
    
      
        <div class="aplayer-container">
          


        </div>
      
    
  </footer>


        <a id="s-top" class="fas fa-arrow-up fa-fw" href="javascript:void(0)"></a>
      </div>
    </div>
    <div>
      <script>
window.volantis={};
window.volantis.loadcss=document.getElementById("loadcss");
/********************脚本懒加载函数********************************/
function loadScript(src, cb) {
var HEAD = document.getElementsByTagName('head')[0] || document.documentElement;
var script = document.createElement('script');
script.setAttribute('type','text/javascript');
if (cb) script.onload = cb;
script.setAttribute('src', src);
HEAD.appendChild(script);
}
//https://github.com/filamentgroup/loadCSS
var loadCSS = function( href, before, media, attributes ){
	var doc = window.document;
	var ss = doc.createElement( "link" );
	var ref;
	if( before ){
		ref = before;
	}
	else {
		var refs = ( doc.body || doc.getElementsByTagName( "head" )[ 0 ] ).childNodes;
		ref = refs[ refs.length - 1];
	}
	var sheets = doc.styleSheets;
	if( attributes ){
		for( var attributeName in attributes ){
			if( attributes.hasOwnProperty( attributeName ) ){
				ss.setAttribute( attributeName, attributes[attributeName] );
			}
		}
	}
	ss.rel = "stylesheet";
	ss.href = href;
	ss.media = "only x";
	function ready( cb ){
		if( doc.body ){
			return cb();
		}
		setTimeout(function(){
			ready( cb );
		});
	}
	ready( function(){
		ref.parentNode.insertBefore( ss, ( before ? ref : ref.nextSibling ) );
	});
	var onloadcssdefined = function( cb ){
		var resolvedHref = ss.href;
		var i = sheets.length;
		while( i-- ){
			if( sheets[ i ].href === resolvedHref ){
				return cb();
			}
		}
		setTimeout(function() {
			onloadcssdefined( cb );
		});
	};
	function loadCB(){
		if( ss.addEventListener ){
			ss.removeEventListener( "load", loadCB );
		}
		ss.media = media || "all";
	}
	if( ss.addEventListener ){
		ss.addEventListener( "load", loadCB);
	}
	ss.onloadcssdefined = onloadcssdefined;
	onloadcssdefined( loadCB );
	return ss;
};
</script>
<script>
  
  loadCSS("https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14/css/all.min.css", window.volantis.loadcss);
  
  
  loadCSS("https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css", window.volantis.loadcss);
  
  
  loadCSS("https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css", window.volantis.loadcss);
  
  
  loadCSS("https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10/build/styles/solarized-light.min.css", window.volantis.loadcss);
  
</script>
<!-- required -->

<script src="https://cdn.jsdelivr.net/npm/jquery@3.5/dist/jquery.min.js"></script>

<script>
  function pjax_fancybox() {
    $(".md .gallery").find("img").each(function () { //渲染 fancybox
      var element = document.createElement("a"); // a 标签
      $(element).attr("class", "fancybox");
      $(element).attr("pjax-fancybox", "");  // 过滤 pjax
      $(element).attr("href", $(this).attr("src"));
      if ($(this).attr("data-original")) {
        $(element).attr("href", $(this).attr("data-original"));
      }
      $(element).attr("data-fancybox", "images");
      var caption = "";   // 描述信息
      if ($(this).attr('alt')) {  // 判断当前页面是否存在描述信息
        $(element).attr('data-caption', $(this).attr('alt'));
        caption = $(this).attr('alt');
      }
      var div = document.createElement("div");
      $(div).addClass("fancybox");
      $(this).wrap(div); // 最外层套 div ，其实主要作用还是 class 样式
      var span = document.createElement("span");
      $(span).addClass("image-caption");
      $(span).text(caption); // 加描述
      $(this).after(span);  // 再套一层描述
      $(this).wrap(element);  // 最后套 a 标签
    })
    $(".md .gallery").find("img").fancybox({
      selector: '[data-fancybox="images"]',
      hash: false,
      loop: false,
      closeClick: true,
      helpers: {
        overlay: {closeClick: true}
      },
      buttons: [
        "zoom",
        "close"
      ]
    });
  };
  function SCload_fancybox() {
    if ($(".md .gallery").find("img").length == 0) return;
    loadCSS("https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css", document.getElementById("loadcss"));
    setTimeout(function() {
      loadScript('https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js', pjax_fancybox)
    }, 1);
  };
  $(function () {
    SCload_fancybox();
  });
</script>


<!-- internal -->



  
  

  <div id="rightmenu-wrapper">
    <ul class="list-v rightmenu" id="rightmenu-content">
      <li class='option'>
        <a class='vlts-menu opt fix-cursor-default' id='menu-copy-text' onclick="document.execCommand('copy')"><i class='fa fa-copy fa-fw'></i>复制文本</a>
        <hr id='hr-text'>
        <a class='vlts-menu opt fix-cursor-default' id='menu-copy-href'><i class='fa fa-link fa-fw'></i>复制链接</a>
        <a class='vlts-menu opt fix-cursor-default' id='menu-open-href'><i class='fa fa-external-link-square-alt fa-fw'></i>在新标签页打开</a>
        <hr id='hr-href'>
        <a class='vlts-menu opt fix-cursor-default' id='menu-copy-src'><i class='fa fa-image fa-fw'></i>复制图片地址</a>
        <hr id='hr-src'>
      </li>
      
        <li class='navigation'>
          <a class='nav icon-only fix-cursor-default' onclick='history.back()'><i class='fa fa-arrow-left fa-fw'></i></a>
          <a class='nav icon-only fix-cursor-default' onclick='history.forward()'><i class='fa fa-arrow-right fa-fw'></i></a>
          <a class='nav icon-only fix-cursor-default' onclick='window.location.reload()'><i class='fa fa-redo fa-fw'></i></a>
          <a class='nav icon-only fix-cursor-default' href='/'><i class='fa fa-home fa-fw'></i></a>
        </li>
      
      <hr>
      
        
      
        
          
    <li>
      <a class='vlts-menu fix-cursor-default' href=https://www.zhuangzhihao.top
        
        
        
        
          id="https:wwwzhuangzhihaotop"
        >
        <i class='fa fa-fan fa-spin fa-fw'></i> 返回主页
      </a>
    </li>
  
        
      
        
          
    <li>
      <a class='vlts-menu fix-cursor-default' href=https://github.com/Bezhuang/Hexo-blog
        
        
        
        
          id="https:githubcomBezhuangHexo-blog"
        >
        <i class='fa fa-code-branch fa-fw'></i> 本站源码
      </a>
    </li>
  
        
      
        
          <hr>
        
      
        
          
    <li>
      <a class='vlts-menu fix-cursor-default' 
        
        
        
          onclick="document.execCommand('print')"
        
        >
        <i class='fa fa-print fa-fw'></i> 打印页面
      </a>
    </li>
  
        
      
    </ul>
  </div>

  <script>
    window.document.oncontextmenu = function (event) {
      if (event.ctrlKey) return true;
      if (/Android|webOS|BlackBerry/i.test(navigator.userAgent)) return true;
      return popMenu(event);
    };
    document.addEventListener("click", function (event) {
      var mymenu = document.getElementById('rightmenu-wrapper');
      mymenu.style.display = "none";
    });
    function popMenu(event) {
      var mymenu = document.getElementById('rightmenu-wrapper');
      var menuContent = document.getElementById('rightmenu-content');
      var screenWidth = document.documentElement.clientWidth || document.body.clientWidth;
      var screenHeight = document.documentElement.clientHeight || document.body.clientHeight;
      mymenu.style.left = event.clientX + "px"; // 获取鼠标位置
      mymenu.style.top = event.clientY + "px";
      mymenu.style.display = 'block';
      if (event.clientX * 2 > screenWidth) {
        menuContent.classList.add('left');
      } else {
        menuContent.classList.remove('left');
      }
      if (event.clientY * 2 > screenHeight) {
        menuContent.classList.add('top');
      } else {
        menuContent.classList.remove('top');
      }

      let hrText = document.getElementById('hr-text');
      let hrSrc = document.getElementById('hr-src');
      let hrHref = document.getElementById('hr-href');

      // 选中图片
      let copySrc = document.getElementById('menu-copy-src');
      if (copySrc != undefined) {
        if (event.target.currentSrc) {
          copySrc.style.display = 'block';
          copySrc.addEventListener("click", function (e) {
            copyString(event.target.currentSrc);
          },{once: true});
          hrSrc.style.display = 'block';
        } else {
          copySrc.style.display = 'none';
          hrSrc.style.display = 'none';
        }
      }

      // 选中按钮
      // 判断是不是按钮
      let href = '';
      if (event.path) {
        for (i = 0; i < event.path.length; i++) {
          if (event.path[i].href != undefined && event.path[i].href.length > 0) {
            href = event.path[i].href;
          }
        }
      }

      let copyText = document.getElementById('menu-copy-text');
      copyText.style.display = 'none';
      hrText.style.display = 'none';
      if (href.length == 0) {
        // 选中文本
        if (window.getSelection().toString()) {
          if ('true' == 'true') {
            copyText.style.display = 'block';
            hrText.style.display = 'block';
          }
        }
      }

      // 在新标签页打开
      let openHref = document.getElementById('menu-open-href');
      if (openHref != undefined) {
        if (href.length > 0) {
          openHref.style.display = 'block';
          openHref.addEventListener("click", function (e) {
            window.open(href);
          },{once: true});
          hrHref.style.display = 'block';
        } else {
          openHref.style.display = 'none';
          hrHref.style.display = 'none';
        }
      }
      // 复制链接
      let copyHref = document.getElementById('menu-copy-href');
      if (copyHref != undefined) {
        if (href.length > 0) {
          copyHref.style.display = 'block';
          copyHref.addEventListener("click", function (e) {
            copyString(href);
          },{once: true});
        } else {
          copyHref.style.display = 'none';
        }
      }

      // 有音乐播放器
      if ('false' == true && ('home,contributors,source_docs,hr,print'||[]).includes('music')) {
        // 如果有aplayer，初始化一下
      	try {
      		checkAPlayer();
          updateTitle();
      	} catch (error) {
      		console.log(error);
      	}
      }

      return false; // 该行代码确保系统自带的右键菜单不会被调出
    }
    function hideMenu() {
      document.getElementById('rightmenu-wrapper').style.display = 'none';
    }
    function copyString(str) {
      const input = document.createElement('input');
      input.setAttribute('readonly', 'readonly');
      document.body.appendChild(input);
      input.setAttribute('value', str);
      input.select();
      document.execCommand('copy');
      document.body.removeChild(input);
    }
    document.execCommand('click');
  </script>




<script>
  function loadIssuesJS() {
    if ($(".md").find(".issues-api").length == 0) return;
    setTimeout(function() {
	
	  loadScript('https://cdn.jsdelivr.net/npm/hexo-theme-volantis@4.3.0/source/js/issues.min.js');
	
    }, 1);
  };
  $(function () {
    loadIssuesJS();
  });
</script>





  
  
    <script async src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
  




  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
    var clipboard = new ClipboardJS('.btn-copy', {
        target: function (trigger) {
            return trigger.nextElementSibling
        }
    });
    function wait(callback, seconds) {
        var timelag = null;
        timelag = window.setTimeout(callback, seconds)
    }
    function pjax_initCopyCode() {
		if($(".highlight .code pre").length+$(".article pre code").length==0)return;
        var copyHtml = '';
        copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
        copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
        copyHtml += '</button>';
        $(".highlight .code pre").before(copyHtml);
        $(".article pre code").before(copyHtml);
        clipboard.off('success').on('success', function (e) {
            let $btn = $(e.trigger);
            $btn.addClass('copied');
            let $icon = $($btn.find('i'));
            $icon.removeClass('fa-copy');
            $icon.addClass('fa-check-circle');
            let $span = $($btn.find('span'));
            $span[0].innerText = 'COPIED';
            wait(function () {
                $icon.removeClass('fa-check-circle');
                $icon.addClass('fa-copy');
                $span[0].innerText = 'COPY'
            }, 2000)
        });
        clipboard.off('error').on('error', function (e) {
            e.clearSelection();
            let $btn = $(e.trigger);
            $btn.addClass('copy-failed');
            let $icon = $($btn.find('i'));
            $icon.removeClass('fa-copy');
            $icon.addClass('fa-times-circle');
            let $span = $($btn.find('span'));
            $span[0].innerText = 'COPY FAILED';
            wait(function () {
                $icon.removeClass('fa-times-circle');
                $icon.addClass('fa-copy');
                $span[0].innerText = 'COPY'
            }, 2000)
        })
    }
    $(function () {
        pjax_initCopyCode()
    });
</script>




   <script type="text/javascript">
  loadScript("https://cdn.jsdelivr.net/npm/scrollreveal@4.0.6/dist/scrollreveal.min.js")
  function pjax_scrollrebeal() {
    ScrollReveal().reveal('.l_main .reveal', {
      distance: '32px',
      duration: '800',
      interval: '20',
      scale: '1',
      easing: 'ease-out'
    });
  }
  $(function () {
  var checkScrollReveal = setInterval(function () {
    if ($("#safearea").css("display")!="block") return
    if (typeof ScrollReveal=="undefined") return
    clearInterval(checkScrollReveal)
	pjax_scrollrebeal();
  }, 100)
  });
</script>






  
  
<script src="https://cdn.jsdelivr.net/npm/hexo-theme-volantis@4.3.0/source/js/valine.min.js"></script>


<script>
  function emoji(path, idx, ext) {
    return path + "/" + path + "-" + idx + "." + ext;
  }
  var emojiMaps = {};
  for (var i = 1; i <= 54; i++) {
    emojiMaps['tieba-' + i] = emoji('tieba', i, 'png');
  }
  for (var i = 1; i <= 101; i++) {
    emojiMaps['qq-' + i] = emoji('qq', i, 'gif');
  }
  for (var i = 1; i <= 116; i++) {
    emojiMaps['aru-' + i] = emoji('aru', i, 'gif');
  }
  for (var i = 1; i <= 125; i++) {
    emojiMaps['twemoji-' + i] = emoji('twemoji', i, 'png');
  }
  for (var i = 1; i <= 4; i++) {
    emojiMaps['weibo-' + i] = emoji('weibo', i, 'png');
  }
  function pjax_valine() {
    if(!document.querySelectorAll("#valine_container")[0])return;
    let pagePlaceholder = pdata.commentPlaceholder || "快来评论吧~";
    let path = pdata.commentPath;
    if (path.length == 0) {
      let defaultPath = '';
      path = defaultPath || decodeURI(window.location.pathname);
    }
    var valine = new Valine();
    valine.init(Object.assign({"path":null,"placeholder":"快来评论吧~","appId":"SK7sx66NNd5Bw3O3jvF2MVXq-MdYXbMMI","appKey":"j5I5paEqIfWfOlCg13vU2vNq","meta":["nick","mail","link"],"requiredFields":["nick"],"enableQQ":true,"recordIP":true,"avatar":"robohash","pageSize":10,"lang":"zh-cn","highlight":true,"mathJax":true}, {
      el: '#valine_container',
      path: path,
      placeholder: pagePlaceholder,
      emojiCDN: 'https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/valine/',
      emojiMaps: emojiMaps,
    }))
  }
  $(function () {
    pjax_valine();
  });
  pjax_comment=pjax_valine;
</script>




  <script defer src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js" data-pjax></script>


  
<script src="https://cdn.jsdelivr.net/npm/hexo-theme-volantis@4.3.0/source/js/app.min.js"></script>



<!-- optional -->

  <script>
const SearchServiceimagePath="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@master/img/";
const ROOT =  ("/" || "/").endsWith('/') ? ("/" || "/") : ("//" || "/" );

$('.input.u-search-input').one('focus',function(){
	
		loadScript('https://cdn.jsdelivr.net/npm/hexo-theme-volantis@4.3.0/source/js/search/hexo.min.js',setSearchService);
	
})

function listenSearch(){
  
    customSearch = new HexoSearch({
      imagePath: SearchServiceimagePath
    });
  
}
function setSearchService() {
	listenSearch();
	
		document.addEventListener("pjax:success", listenSearch);
	
}
</script>





  
<script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>

  <script type="text/javascript">
    $(function () {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>



  
<script src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@2/js/comment_typing.js"></script>




  
    
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10/build/highlight.min.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
  



  <script defer>

  const LCCounter = {
    app_id: 'SK7sx66NNd5Bw3O3jvF2MVXq-MdYXbMMI',
    app_key: 'j5I5paEqIfWfOlCg13vU2vNq',
    custom_api_server: '',

    // 查询存储的记录
    getRecord(Counter, url, title) {
      return new Promise(function (resolve, reject) {
        Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({url})))
          .then(resp => resp.json())
          .then(({results, code, error}) => {
            if (code === 401) {
              throw error;
            }
            if (results && results.length > 0) {
              var record = results[0];
              resolve(record);
            } else {
              Counter('post', '/classes/Counter', {url, title: title, times: 0})
                .then(resp => resp.json())
                .then((record, error) => {
                  if (error) {
                    throw error;
                  }
                  resolve(record);
                }).catch(error => {
                console.error('Failed to create', error);
                reject(error);
              });
            }
          }).catch((error) => {
          console.error('LeanCloud Counter Error:', error);
          reject(error);
        });
      })
    },

    // 发起自增请求
    increment(Counter, incrArr) {
      return new Promise(function (resolve, reject) {
        Counter('post', '/batch', {
          "requests": incrArr
        }).then((res) => {
          res = res.json();
          if (res.error) {
            throw res.error;
          }
          resolve(res);
        }).catch((error) => {
          console.error('Failed to save visitor count', error);
          reject(error);
        });
      });
    },

    // 构建自增请求体
    buildIncrement(objectId) {
      return {
        "method": "PUT",
        "path": `/1.1/classes/Counter/${ objectId }`,
        "body": {
          "times": {
            '__op': 'Increment',
            'amount': 1
          }
        }
      }
    },

    // 校验是否为有效的 UV
    validUV() {
      var key = 'LeanCloudUVTimestamp';
      var flag = localStorage.getItem(key);
      if (flag) {
        // 距离标记小于 24 小时则不计为 UV
        if (new Date().getTime() - parseInt(flag) <= 86400000) {
          return false;
        }
      }
      localStorage.setItem(key, new Date().getTime().toString());
      return true;
    },

    addCount(Counter) {
      var enableIncr = '' === 'true' && window.location.hostname !== 'localhost';
      enableIncr = true;
      var getterArr = [];
      var incrArr = [];
      // 请求 PV 并自增
      var pvCtn = document.querySelector('#lc-sv');
      if (pvCtn || enableIncr) {
        var pvGetter = this.getRecord(Counter, 'http://blog.zhuangzhihao.top' + '/#lc-sv', 'Visits').then((record) => {
          incrArr.push(this.buildIncrement(record.objectId))
          var eles = document.querySelectorAll('#lc-sv #number');
          if (eles.length > 0) {
            eles.forEach((el,index,array)=>{
              el.innerText = record.times + 1;
              if (pvCtn) {
                pvCtn.style.display = 'inline';
              }
            })
          }
        });
        getterArr.push(pvGetter);
      }

      // 请求 UV 并自增
      var uvCtn = document.querySelector('#lc-uv');
      if (uvCtn || enableIncr) {
        var uvGetter = this.getRecord(Counter, 'http://blog.zhuangzhihao.top' + '/#lc-uv', 'Visitors').then((record) => {
          var vuv = this.validUV();
          vuv && incrArr.push(this.buildIncrement(record.objectId))
          var eles = document.querySelectorAll('#lc-uv #number');
          if (eles.length > 0) {
            eles.forEach((el,index,array)=>{
              el.innerText = record.times + (vuv ? 1 : 0);
              if (uvCtn) {
                uvCtn.style.display = 'inline';
              }
            })
          }
        });
        getterArr.push(uvGetter);
      }

      // 请求文章的浏览数，如果是当前页面就自增
      var allPV = document.querySelectorAll('#lc-pv');
      if (allPV.length > 0 || enableIncr) {
        for (i = 0; i < allPV.length; i++) {
          let pv = allPV[i];
          let title = pv.getAttribute('data-title');
          var url = 'http://blog.zhuangzhihao.top' + pv.getAttribute('data-path');
          if (url) {
            var viewGetter = this.getRecord(Counter, url, title).then((record) => {
              // 是当前页面就自增
              let curPath = window.location.pathname;
              if (curPath.includes('index.html')) {
                curPath = curPath.substring(0, curPath.lastIndexOf('index.html'));
              }
              if (pv.getAttribute('data-path') == curPath) {
                incrArr.push(this.buildIncrement(record.objectId));
              }
              if (pv) {
                var ele = pv.querySelector('#lc-pv #number');
                if (ele) {
                  if (pv.getAttribute('data-path') == curPath) {
                    ele.innerText = (record.times || 0) + 1;
                  } else {
                    ele.innerText = record.times || 0;
                  }
                  pv.style.display = 'inline';
                }
              }
            });
            getterArr.push(viewGetter);
          }
        }
      }

      // 如果启动计数自增，批量发起自增请求
      if (enableIncr) {
        Promise.all(getterArr).then(() => {
          incrArr.length > 0 && this.increment(Counter, incrArr);
        })
      }

    },


    fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${ api_server }/1.1${ url }`, {
          method,
          headers: {
            'X-LC-Id': this.app_id,
            'X-LC-Key': this.app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      this.addCount(Counter);
    },

    refreshCounter() {
      var api_server = this.app_id.slice(-9) !== '-MdYXbMMI' ? this.custom_api_server : `https://${ this.app_id.slice(0, 8).toLowerCase() }.api.lncldglobal.com`;
      if (api_server) {
        this.fetchData(api_server);
      } else {
        fetch('https://app-router.leancloud.cn/2/route?appId=' + this.app_id)
          .then(resp => resp.json())
          .then(({api_server}) => {
            this.fetchData('https://' + api_server);
          });
      }
    }

  };

  LCCounter.refreshCounter();

  document.addEventListener('pjax:complete', function () {
    LCCounter.refreshCounter();
  });
</script>




  <script>
const rootElement = document.documentElement;
const darkModeStorageKey = "user-color-scheme";
const rootElementDarkModeAttributeName = "data-user-color-scheme";

const setLS = (k, v) => {
    localStorage.setItem(k, v);
};

const removeLS = (k) => {
    localStorage.removeItem(k);
};

const getLS = (k) => {
    return localStorage.getItem(k);
};

const getModeFromCSSMediaQuery = () => {
  return window.matchMedia("(prefers-color-scheme: dark)").matches
    ? "dark"
    : "light";
};

const resetRootDarkModeAttributeAndLS = () => {
  rootElement.removeAttribute(rootElementDarkModeAttributeName);
  removeLS(darkModeStorageKey);
};

const validColorModeKeys = {
  dark: true,
  light: true,
};

const applyCustomDarkModeSettings = (mode) => {
  const currentSetting = mode || getLS(darkModeStorageKey);

  if (currentSetting === getModeFromCSSMediaQuery()) {
    resetRootDarkModeAttributeAndLS();
  } else if (validColorModeKeys[currentSetting]) {
    rootElement.setAttribute(rootElementDarkModeAttributeName, currentSetting);
  } else {
    resetRootDarkModeAttributeAndLS();
  }
};

const invertDarkModeObj = {
  dark: "light",
  light: "dark",
};

/**
 * get target mode
 */
const toggleCustomDarkMode = () => {
  let currentSetting = getLS(darkModeStorageKey);

  if (validColorModeKeys[currentSetting]) {
    currentSetting = invertDarkModeObj[currentSetting];
  } else if (currentSetting === null) {
    currentSetting = invertDarkModeObj[getModeFromCSSMediaQuery()];
  } else {
    return;
  }
  setLS(darkModeStorageKey, currentSetting);
  return currentSetting;
};

/**
 * bind click event for toggle button
 */
function bindToggleButton() {
	var btn=$("#wrapper .toggle-mode-btn");
    btn.on('click',(e) => {
      const mode = toggleCustomDarkMode();
      applyCustomDarkModeSettings(mode);
    });
}

applyCustomDarkModeSettings();
document.addEventListener("DOMContentLoaded", bindToggleButton);
document.addEventListener("pjax:success", bindToggleButton);

</script>







<script src="//code.tidio.co/tu8j8vmfuovtkhsj4lgr7sub986gd1ku.js" async></script>


<script>
function listennSidebarTOC() {
  const navItems = document.querySelectorAll(".toc li");
  if (!navItems.length) return;
  const sections = [...navItems].map((element) => {
    const link = element.querySelector(".toc-link");
    const target = document.getElementById(
      decodeURI(link.getAttribute("href")).replace("#", "")
    );
    link.addEventListener("click", (event) => {
      event.preventDefault();
      window.scrollTo({
		top: target.offsetTop + 100,
		
		behavior: "smooth"
		
	  });
    });
    return target;
  });

  function activateNavByIndex(target) {
    if (target.classList.contains("active-current")) return;

    document.querySelectorAll(".toc .active").forEach((element) => {
      element.classList.remove("active", "active-current");
    });
    target.classList.add("active", "active-current");
    let parent = target.parentNode;
    while (!parent.matches(".toc")) {
      if (parent.matches("li")) parent.classList.add("active");
      parent = parent.parentNode;
    }
  }

  function findIndex(entries) {
    let index = 0;
    let entry = entries[index];
    if (entry.boundingClientRect.top > 0) {
      index = sections.indexOf(entry.target);
      return index === 0 ? 0 : index - 1;
    }
    for (; index < entries.length; index++) {
      if (entries[index].boundingClientRect.top <= 0) {
        entry = entries[index];
      } else {
        return sections.indexOf(entry.target);
      }
    }
    return sections.indexOf(entry.target);
  }

  function createIntersectionObserver(marginTop) {
    marginTop = Math.floor(marginTop + 10000);
    let intersectionObserver = new IntersectionObserver(
      (entries, observe) => {
        let scrollHeight = document.documentElement.scrollHeight + 100;
        if (scrollHeight > marginTop) {
          observe.disconnect();
          createIntersectionObserver(scrollHeight);
          return;
        }
        let index = findIndex(entries);
        activateNavByIndex(navItems[index]);
      },
      {
        rootMargin: marginTop + "px 0px -100% 0px",
        threshold: 0,
      }
    );
    sections.forEach((element) => {
      element && intersectionObserver.observe(element);
    });
  }
  createIntersectionObserver(document.documentElement.scrollHeight);
}

document.addEventListener("DOMContentLoaded", listennSidebarTOC);
document.addEventListener("pjax:success", listennSidebarTOC);
</script>

<!-- more -->

 
	   
	    


<script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script>


<script>
    var pjax;
    document.addEventListener('DOMContentLoaded', function () {
      pjax = new Pjax({
        elements: 'a[href]:not([href^="#"]):not([href="javascript:void(0)"]):not([pjax-fancybox])',
        selectors: [
          "title",
          "#l_cover",
          "#pjax-container",
          "#pjax-header-nav-list"
        ],
        cacheBust: false,   // url 地址追加时间戳，用以避免浏览器缓存
        timeout: 5000
      });
    });

    document.addEventListener('pjax:send', function (e) {
      //window.stop(); // 相当于点击了浏览器的停止按钮

      try {
        var currentUrl = window.location.pathname;
        var targetUrl = e.triggerElement.href;
        var banUrl = ["/artitalk/"];
        if (banUrl[0] != "") {
          banUrl.forEach(item => {
            if(currentUrl.indexOf(item) != -1 || targetUrl.indexOf(item) != -1) {
              window.location.href = targetUrl;
            }
          });
        }
      } catch (error) {}

      window.subData = null; // 移除标题（用于一二级导航栏切换处）
      if (typeof $.fancybox != "undefined") {
        $.fancybox.close();    // 关闭弹窗
      }
      volantis.$switcher.removeClass('active'); // 关闭移动端激活的搜索框
      volantis.$header.removeClass('z_search-open'); // 关闭移动端激活的搜索框
      volantis.$wrapper.removeClass('sub'); // 跳转页面时关闭二级导航

      // 解绑事件 避免重复监听
      volantis.$topBtn.unbind('click');
      $('.menu a').unbind('click');
      $(window).unbind('resize');
      $(window).unbind('scroll');
      $(document).unbind('scroll');
      $(document).unbind('click');
      $('body').unbind('click');
      
      $("#wrapper .toggle-mode-btn").unbind('click');
      
	  
    });

    document.addEventListener('pjax:complete', function () {
      // 关于百度统计对 SPA 页面的处理：
      // 方案一：百度统计>管理>单页应用设置中，打开开启按钮即可对SPA进行统计。 https://tongji.baidu.com/web/help/article?id=324
      // 方案二：取消注释下列代码。 https://tongji.baidu.com/web/help/article?id=235
       

      // 关于谷歌统计对 SPA 页面的处理：
      // 当应用以动态方式加载内容并更新地址栏中的网址时，也应该更新通过 gtag.js 存储的网页网址。
      // https://developers.google.cn/analytics/devguides/collection/gtagjs/single-page-applications?hl=zh-cn
      


      $('.nav-main').find('.list-v').not('.menu-phone').removeAttr("style",""); // 移除小尾巴的移除
      $('.menu-phone.list-v').removeAttr("style",""); // 移除小尾巴的移除
      $('script[data-pjax], .pjax-reload script').each(function () {
        $(this).parent().append($(this).remove());
      });
      try{
          if (typeof $.fancybox == "undefined") {
            SCload_fancybox();
          } else {
            pjax_fancybox();
          }
        
        
        document.querySelectorAll('pre code').forEach((block) => {
          hljs.highlightBlock(block);
        });
        
        
          pjax_scrollrebeal();
        
        if (typeof IssuesAPI == "undefined") {
          loadIssuesJS();
        }
        
          pjax_initCopyCode();
        
		
          try{pjax_comment();} catch (e) {}
        
      } catch (e) {
        console.log(e);
      }
	  
    });

    document.addEventListener('pjax:error', function (e) {
	  
      window.location.href = e.triggerElement.href;
    });
</script>
 
	  
    </div>
  </body>
</html>
<!--单击显示文字-->
<script type="text/javascript" src="/js/click_show_text.js"></script>
<!--浏览器搞笑标题-->
<!--<script type="text/javascript" src="/js/FunnyTitle.js"></script>-->
<!-- 数字雨 -->
<canvas id="canvas" width="1440" height="900" ></canvas>
<script type="text/javascript" src="/js/DigitalRain.js"></script>
